# 2024第四届“网鼎杯”网络安全大赛半决赛

第四届“网鼎杯”网络安全大赛半决赛采用“专项技术挑战赛（夺旗赛）”、“安全运营挑战赛（综合防御赛）”及“风险隐患挖掘赛（靶场渗透赛）”三种赛制相融合的竞技方式。

## 专项技术挑战赛

考察参赛战队在网络安全领域的技术能力，包括逆向安全、二进制安全、密码学、数据安全及新技术应用（如车联网、物联网、5G 通信），通过解题获取 flag 得分。

### 二进制安全

#### 二进制漏洞挖掘 - cardmaster

> 请卡牌大师们找出这台切牌机中的漏洞并获取 flag

#### 系统内核漏洞挖掘 - Generic_kernel_shellcode

> Write a generic linux kernel shellcode?

#### 新编译技术漏洞 - jitlover

> 这是一台不完全的 JIT 虚拟机，请找到其中的漏洞以获取 flag

### 密码学

#### RSA 加密分析 - equations

> rsa 真的安全吗

#### 序列密码加密分析 - noise

> Let me tell you a story about noisy-nfsr.

### 数据安全

#### 邮件数据分析

> 公司的 DLP 软件报警了，并上传了一段流量。你能帮 bob 分析下为什么会产生报警么？

#### 数据安全协议分析

> 自定义 TLS 协议可能会存在安全问题，本题实现 TLS 的 Hello 部分，再利用 AES CFB 模式的性质伪造签名后的消息。端口为 23333，nc 正常无法连接上，需要根据 server 实现客户端链接。

### 新技术应用

#### 车联网日志分析 - V2XLogAnalysis

> 车内日志的秘密，日志也能注入？

<https://www.bilibili.com/opus/1004129835910430736>

#### IOT 应用容器漏洞 - signin

> 难道这是真正的登陆入口吗？

#### IOT 网络协议分析 - babyRTP

> 这是一个双端都会推流的服务

#### 5G 网络隐私保护 - Get_supi

> 在某些场景下，LTE 网络中用户的 IMSI 会在空口暴露，5G 网络是如何进行隐私保护的？网络侧如何得到用户的 SUPI？（提交请加上 flag{}）
>
### 逆向安全

#### python 逆向分析 - compress

> 一个幽灵，一个EOL的幽灵在代码审计中游荡。

#### 网络通信流量分析 - socket

> 小鼎同学在日常运维排查中发现了异常通信流量，通过初步定位分析，他获得了客户端、服务端程序以及相关流量，请帮他找出其中异常敏感数据！

## 安全运营挑战赛

> 在本题目中勒索软件样本为真实样本，请选手一定在虚拟环境中分析，不要在物理机中有任何分析操作，如若造成物理机及数据被加密或损坏，造成损失由选手个人承担，主办方不承担任何责任。

考察参赛战队在典型网络环境中的安全运营能力，包括加固修复、应急响应等任务，通过完成靶机上的对应运营任务得分。

### 加固修复

SSH 服务于 22 端口，账号 user，密码 123456

#### 01 加强SSH服务的安全性

> 为了防止SSH服务被暴力破解攻击，应禁用密码登录并改用密钥认证。请在Linux服务器上为root用户配置以下公钥以进行验证ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEhw/9RBAh4qW36/LZXn80sLIZhq2hAJ7qY9KhzfJ3rW

```bash
ssh-keygen -t ed25519

vim /etc/ssh/sshd_config
```

#### 02 配置Nginx重定向和HSTS

> 配置Linux服务器的Nginx服务，将所有站点的HTTP请求重定向到HTTPS，并配置严格传输安全策略（HSTS），以确保客户端与服务器之间的通信安全。

#### 03 启用Web应用防火墙

> 为Nginx服务的默认站点启用ModSecurity Web应用防火墙，并集成OWASP核心规则集（CRS），以防御常见的Web攻击和漏洞利用。

#### 04 加强防火墙策略

> 配置Linux服务器的防火墙，使其仅允许通过以下端口的访问：22/tcp（SSH）、53/tcp和53/udp（DNS）、80/tcp（HTTP）、443/tcp（HTTPS）。关闭其他不必要的端口，减少攻击面。

#### 05 优化Kubernetes RBAC权限

> 配置App1应用的Kubernetes RBAC权限，只允许读取App1应用命名空间下所有Pods的信息，防止越权访问其他命名空间的资源。

#### 06 修复Kubernetes服务

> 使Pods状态为running，确保应用的可用性。

#### 07 修复App2应用漏洞

> 修复App2应用的已知漏洞，并重新部署App2应用，确保其安全性和稳定性。

### 应急响应

ssh 服务于 22 端口，账号 root，密码 FD7!#fd8s
web 服务于 80 端口，账号 admin，密码 JD67s@!#l

#### 01 查明并处理植入的后门

> 公司Web业务系统遭受黑客攻击，并被植入后门。请您立即进行排查和处理，确保系统的安全性和完整性。

#### 02 定位持久化服务和木马文件

> 找到Linux服务器中驻留的持久化服务，并将持久化技术所依赖的二进制木马文件复制到/home/user/checker目录中。

#### 03 卸载恶意模块

> 找到Linux服务器被加载的恶意模块并卸载，恢复系统的正常功能。

#### 04 发现并提取隐藏的进程

> 找到 Linux 服务器中隐藏的进程，并将该进程的二进制文件复制到 /home/user/checker 目录中，为后续分析提供依据。

#### 05 查找被删除的勒案软件名称

> 找到攻击者被记录的删除加密勒索软件的痕迹，尝试恢复分析该勒索软件并提交勒索软件十六进制格式的加密密钥到/home/user/checker/key.txt文件中，以便于解密攻击者勒索的文件。

#### 06 恢复被加密的数据

> 恢复服务器上被勒索软件加密的分区数据到/home/user/checker目录，确保业务数据的完整性和可用性。

#### 07 查明并处理篡改的首页

> 公司Web业务系统首页遭受黑客攻击，并被植入恶意链接。请您立即进行排查和处理受影响的首页，确保系统的可用性、安全性和完整性。

### 威胁分析

ssh 服务于 22 端口，账号 root，密码 toor

#### 01

在调查网络性能或安全问题时，了解特定应用程序在一段时间内的数据传输情况对于检测异常流量和潜在威胁至关重要。通过分析网络活动日志，我们可以确定是否存在数据泄露或异常通信。

> 请问，firefox进程自有记录以来一共发送了多少字节的数据？（请将答案编辑并存入/opt/wxfx/answer/1.txt文件中，参考/opt/wxfx/example目录）

#### 02

识别安全防护软件的查杀记录，对于评估系统受感染的程度和了解攻击者所使用的工具至关重要。通过检查安全日志，可以获取被检测到的威胁信息。

> 请问，Windows Defender 检测到的第一个恶意软件的威胁ID是什么？（请将答案编辑并存入/opt/wxfx/answer/2.txt文件中，参考/opt/wxfx/example目录）

#### 03

了解恶意软件的内部名称（如开发者给它的命名）有助于识别其家族、版本和特定功能，进而制定有效的防御策略。

> 请问，系统中正在运行的恶意软件的内部名称是什么？（请将答案编辑并存入/opt/wxfx/answer/3.txt文件中，参考/opt/wxfx/example目录）

#### 04

逆向分析恶意软件时，确定其在进程内存中存储关键数据的位置，对于理解其工作机制和防范进一步的攻击非常重要。

> 请问，恶意软件在进程内存中存储密钥的内存地址是什么？（请将答案编辑并存入/opt/wxfx/answer/4.txt文件中，参考/opt/wxfx/example目录）

#### 05

分析恶意软件的行为包括了解其在系统中启用了哪些权限，这有助于评估其潜在的危害和攻击范围。通过检查进程的权限列表，可以发现其可能执行的敏感操作。

> 请问，恶意软件在其进程中启用了多少个权限？（请将答案编辑并存入/opt/wxfx/answer/5.txt文件中，参考/opt/wxfx/example目录）

#### 06

在分析勒索软件的行为时，确定其在内存中加载的位置对于深入理解其运行机制和发现潜在的漏洞非常重要。通过内存取证，可以找到打开勒索软件文件的设备的虚拟地址。

> 请问，打开勒索软件文件的设备的虚拟地址是什么（16进制）？（请将答案编辑并存入/opt/wxfx/answer/6.txt文件中，参考/opt/wxfx/example目录）

### 溯源反制

无接入信息，需要通过其他手段实现权限控制

#### 01

> 在用户家目录留下23798632.txt

#### 02

> 尝试在攻击机上提升权限并在提升权限后在高级用户的家目录中留下862382.txt文件

## 风险隐患挖掘赛

考察参赛战队的渗透测试能力，在大型仿真场景中通过信息收集、漏洞扫描和利用获取系统权限或执行命令，找到 flag 提交得分。

## 参考资料

- <https://github.com/CTF-Archives/2024-wdb-Semis-IncidentResponse/>
